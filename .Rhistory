# 绘制差异转录本图
plot_differences <- function(differences, title) {
p <- ggplot() +
geom_segment(data=differences, aes(x=start, y=1, xend=end, yend=1, color=gene_id), size=2) +
scale_color_manual(values=c("green")) +
labs(title=title, x="Position", y="Gene") +
theme_minimal()
print(p)
}
# 安装并加载 DESeq2 包
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
read.table("feature.txt", header = TRUE, row.names = 1, nrows = 3)
read.table("feature.txt", header = TRUE, row.names = 1, nrows = 3)
library(DESeq2)
BiocManager::install(c("ggplot2", "clusterProfiler", "org.At.tair.db"))
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "devel")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "devel")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.22")
BiocManager::install("KEGGREST")
BiocManager::install("KEGGREST")
options(repos = c(
Bioconductor = "https://bioconductor.org/packages/3.22/bioc",  # Bioconductor 镜像
CRAN = "https://mirrors.tuna.tsinghua.edu.cn/CRAN/"  # 清华大学 CRAN 镜像
))
BiocManager::install("KEGGREST")
library(ggplot2)
library(DESeq2)
library(ggplot2)
library(clusterProfiler)
library(org.At.tair.db)
library(Rsubread)
BiocManager::install(c("DESeq2", "ggplot2", "clusterProfiler", "org.At.tair.db", "Rsubread"))
# 安装必要的包
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("DESeq2", "ggplot2", "clusterProfiler", "org.At.tair.db", "Rsubread"))
options(repos = c(
Bioconductor = "https://bioconductor.org/packages/3.22/bioc",  # Bioconductor 镜像
CRAN = "https://mirrors.tuna.tsinghua.edu.cn/CRAN/"  # 清华大学 CRAN 镜像
))
# 安装必要的包
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(c("DESeq2", "ggplot2", "clusterProfiler", "org.At.tair.db", "Rsubread"))
## 在 R 控制台依次执行
BiocManager::install("S4Vectors", force = TRUE, ask = FALSE)
## 在 R 控制台依次执行
BiocManager::install("S4Vectors", force = TRUE, ask = FALSE)
library(DESeq2)
install.packages("Seqinfo")
options(timeout = 600)   # 10 分钟
## 2. 关闭二进制仓库，只保留源码
options(repos = c(CRAN = "https://mirrors.tuna.tsinghua.edu.cn/CRAN/"))
BiocManager::repositories()  # 确认只剩 Bioconductor 源
## 3. 一次性装源码（跳过找不到的二进制）
BiocManager::install(
c("Biobase", "BiocParallel", "Biostrings", "DelayedArray", "DESeq2",
"fgsea", "GenomicRanges", "GOSemSim", "IRanges", "S4Arrays",
"S4Vectors", "SparseArray", "XVector", "KEGGREST", "Seqinfo",
"SummarizedExperiment", "AnnotationDbi", "GO.db"),
type = "source", ask = FALSE
)
pkgs <- dir("D:/bio-pkgs", pattern = "\\.tar\\.gz$", full.names = TRUE)
install.packages(pkgs, repos = NULL, type = "source")
pkgbuild::has_build_tools(debug = TRUE)
pkgbuild::has_build_tools(debug = TRUE)
system("where make")
system("where make")
BiocManager::install("S4Vectors", type = "source", ask = FALSE)
# 告诉 R 用 rtools44
Sys.setenv(PATH = paste("C:/rtools44/usr/bin",
"C:/rtools44/mingw64/bin",
Sys.getenv("PATH"), sep = ";"))
Sys.setenv(BINPREF = "C:/rtools44/mingw64/bin/")
system("gcc --version")
BiocManager::install("S4Vectors", type = "source", ask = FALSE)
system("gcc --version")
BiocManager::install("S4Vectors", type = "source", ask = FALSE)
packageVersion("S4Vectors")   # ≥ 0.47.6 就 OK
pkgs <- dir("D:/bio-pkgs", pattern = "\\.tar\\.gz$", full.names = TRUE)
install.packages(pkgs, repos = NULL, type = "source")
for (p in c("KEGGREST", "Seqinfo")) {
tar <- dir("D:/bio-pkgs", pattern = paste0("^", p, "_.*\\.tar\\.gz$"), full.names = TRUE)
if (length(tar)) install.packages(tar, repos = NULL, type = "source")
}
## 1. 底层
BiocManager::install(c("KEGGREST", "Seqinfo"), type = "source", ask = FALSE)
## 1. 底层
BiocManager::install(c("KEGGREST", "Seqinfo"), type = "source", ask = FALSE)
## 2. 中层
BiocManager::install(c("AnnotationDbi", "GO.db", "Biostrings", "GenomicRanges"),
type = "source", ask = FALSE)
## 3. 顶层
BiocManager::install(c("SummarizedExperiment", "DESeq2", "clusterProfiler",
"org.At.tair.db"), type = "source", ask = FALSE)
library(DESeq2)
library(clusterProfiler)
library(org.At.tair.db)
library(DESeq2)
library(ggplot2)
library(clusterProfiler)
library(org.At.tair.db)
# 2. 读取 counts 和 metadata
counts <- read.table("feature.txt", header = TRUE, row.names = 1, sep = "\t")
library(clusterProfiler)
library(org.At.tair.db)
gene <- c("AT1G78900", "AT1G12980", "AT1G07820", "AT1G80460")
ego <- enrichGO(gene, OrgDb=org.At.tair.db, ont="BP", pAdjustMethod="BH", pvalueCutoff=0.05)
dotplot(ego, showCategory=10)
library(clusterProfiler)
library(org.At.tair.db)
gene <- c("AT1G78900", "AT1G12980", "AT1G07820", "AT1G80460")
# 1. 富集分析：把阈值调大
ego <- enrichGO(gene,
OrgDb       = org.At.tair.db,
ont         = "BP",
pAdjustMethod = "none",   # 不做 BH 校正
pvalueCutoff  = 1,        # 保留所有 term
qvalueCutoff  = 1)
# 2. 画图
dotplot(ego, showCategory = 10)
# 全部 TAIR10 蛋白编码基因作为背景
bg <- keys(org.At.tair.db, keytype = "TAIR")
ego <- enrichGO(gene,
universe      = bg,
OrgDb         = org.At.tair.db,
ont           = "BP",
pAdjustMethod = "BH",
pvalueCutoff  = 0.05)
dotplot(ego, showCategory = 10)
BIO215
setwd("~/BIO215/Practical7")
# 1 安装+加载你的包（自动从本地仓库装）
remotes::install_local(".", force = TRUE, quiet = TRUE)
setwd("C:/Users/DELL/Desktop/study/BIO215/Practical7/m6APrediction")
# 1 安装+加载你的包（自动从本地仓库装）
remotes::install_local(".", force = TRUE, quiet = TRUE)
library(m6APrediction)
# 2 两个导出函数能跑就行（用示例值）
pred1 <- prediction_single("AGCUAGCAUGCAUGCAUGC",
gc_content=0.52, RNA_type="mRNA", RNA_region="3UTR",
exon_length=1200, distance_to_junction=150,
evolutionary_conservation=0.85,
DNA_5mer=dna_encoding("AGCUAGCAUGCAUGC"))
devtools::install(upgrade = "never", quiet = TRUE)
library(m6APrediction)
# 单条预测（5-mer 用随机数代替，仅验证函数能跑）
pred1 <- prediction_single(
seq = "AGCUAGCAUGCAUGCAUGC",
gc_content = 0.52,
RNA_type = "mRNA",
RNA_region = "3UTR",
exon_length = 1200,
distance_to_junction = 150,
evolutionary_conservation = 0.85,
DNA_5mer = rep(0.2, 1024)   # 1024 维 5-mer 向量，用随机数占位
)
# 单条预测
pred1 <- prediction_single(
sequence                  = "AGCUAGCAUGCAUGCAUGCAUGC",
gc_content                = 0.52,
RNA_type                  = "mRNA",
RNA_region                = "3UTR",
exon_length               = 1200,
distance_to_junction      = 150,
evolutionary_conservation = 0.85,
DNA_5mer                  = rep(0.2, 1024)   # 1024 维 5-mer 向量
)
args(prediction_single)
devtools::check()   # 0 errors 是底线
devtools::check()   # 0 errors 是底线
install.packages("devtools")
devtools::install_github("Susiekawaiidesu/m6APrediction")
git status
git --version
git --version
